---
mode: 'agent'
description: '要件定義書作成ワークフローは、フロントエンド成果物とそれに対するフィードバックを元に、要件定義書を作成します。'
tools: ['edit', 'changes', 'codebase', 'editFiles', 'extensions', 'fetch', 'githubRepo', 'openSimpleBrowser', 'problems', 'runTasks', 'search', 'think', 'searchResults', 'terminalLastCommand', 'terminalSelection', 'testFailure', 'usages', 'vscodeAPI', 'microsoft-docs', 'Azure MCP']
---
# 要件定義書作成ワークフロー

現行の[フロントエンド成果物](../../front/)と[仕様へのフィードバック](../../docs/plan/poc_feedback.md)を元に要件定義書(docs/plan/requirements.md)を作成します。

## 作成するドキュメント
 - **requirements.md**: 要件定義書

### 履歴的記録 (/docs/plan/history/)
 - 一時的な分析文書など

 **ドキュメント管理方針**
  - requirements.md は常に最新の状態を反映する
  - タイムスタンプ付きの記録や履歴的な文書は`/docs/plan/history/`配下の適切なサブディレクトリに保存する
  - **すべてのドキュメント内の図表（アーキテクチャ図、シーケンス図、データフロー図、状態遷移図など）はMermaid記法で作成する**

 **ドキュメンテーションルール:**
 詳細なテンプレートをすべてのドキュメンテーションの**主要な情報源**として使用する。

## 実行ステップ

**ステップをスキップしない。一貫した用語を使用する。曖昧さを減らす。**

**重要なプロセス制約:**
- **フェーズ完了時にユーザに合意を得る**

**目的:**

- 既存のフロントエンドシステムを分析する。
- 明確でテスト可能な要件のセットを作成する。
- 可能な解決策とその影響について考える。

**利用資料:**

 - [追加仕様](../../docs/plan/poc_feedback.md)は、現行のフロントエンドに対して追加で必要となる要件
 - [フロントエンド成果物](../../front/)は、フロントエンドの実装成果物
 - [フロントエンド作成時のプロダクト要求定義書](../../front/PRD.md)は、現行のフロントエンドのプロダクト要求定義書

**最新情報を取得する**
マイクロソフトAzureやGitHubテクノロジーに関して記載する場合は、ツール'microsoft-docs'を使用して最新情報を取得し、最新で正確な全情報を読み込むこと。

**チェックリスト:**

- [ ] 提供されたすべてのドキュメントを読む。
      - ファイルのインベントリ、要約、初期分析結果を文書化する。
- [ ] **EARS記法**で要件を定義する:
      - 機能リクエストを構造化されたテスト可能な要件に変換する。
      - 形式: `システムは常に [期待される動作] するものとする`
- [ ] 依存関係と制約を特定する。
      - リスクと緩和戦略を含む依存関係グラフを文書化する（Mermaid記法で作成）。
- [ ] データフローと相互作用をマッピングする。
      - システム相互作用図とデータモデルを文書化する（Mermaid記法で作成）。
      - Mermaid記法に構文ミスがないことを確認する。
- [ ] エッジケースと障害をカタログ化する。
      - 包括的なエッジケースマトリックスと潜在的な障害点を文書化する。
- [ ] 信頼度を評価する。
      - 要件の明確さ、複雑さ、問題の範囲に基づいて**信頼度スコア（0-100%）**を生成する。
      - スコアとその根拠を文書化する。
- [ ] 要件定義書(**requirements.md**)をレビューする
        - 本要件定義書はいわゆるスクラム0フェーズの成果物としてレビューする。
        - 要件の明確さ、テスト可能性、実現可能性を確認する。
        - すべての要件がEARS記法に従っていることを確認する。
        - 一般的な要件定義書と比較し、曖昧な点や不足している点があれば指摘する。
        - 信頼度スコアを上げれないか再度検討する。

**重要な制約:**

- **すべての要件が明確で文書化され、レビューでの指摘が無くなるまで修正を繰り返す。**

## EARS記法リファレンス

**EARS（Easy Approach to Requirements Syntax）** - 要件の標準形式:

- **普遍的**: `システムは常に [期待される動作] するものとする`
- **イベント駆動**: `[トリガーイベント] が発生したとき、システムは [期待される動作] するものとする`
- **状態駆動**: `[特定の状態で] の間、システムは [期待される動作] するものとする`
- **望ましくない動作**: `[望ましくない条件] が発生した場合、システムは [必要な応答] するものとする`
- **オプション**: `[機能が含まれる] が有効な場合、システムは [期待される動作] するものとする`
- **複雑**: 洗練された要件のための上記のパターンの組み合わせ

各要件は以下でなければならない:

- **テスト可能**: 自動または手動テストで検証できる
- **曖昧でない**: 単一の解釈のみが可能
- **必要**: システムの目的に貢献する
- **実現可能**: 制約内で実装できる
- **追跡可能**: ユーザーのニーズと設計要素にリンクされている
