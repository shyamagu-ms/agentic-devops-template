# プロダクト追加要件

## 全体アーキテクチャ
 - フロントエンド成果物(`/front` )は静的ファイルにビルドし、Azure Static Web Apps で配布する
 - バックエンド(`/back`)は Azure Functions(.NET8) で実装し、BYOでAzure Static Web Apps とリンクする
 - バックエンドが接続するデータベースは Azure SQL Database とする
  - O/RマッパーとしてDapperを採用
 - その他リソース(Blob Storageや KeyVault)は必要に応じて適切な Azure サービスを採用する

## 認証方式
 - Azure Static WebApps の認証にはEntraIDを用いる
  - 管理権限(admin)ユーザが商品CRUDを実行できる
  - 未認証ユーザは商品一覧を検索・購入することができるが、商品CRUDは実行できない
 - Azure Functions から各Azureサービス(SQLDBやStorage,KeyVaultなど)への接続にはManaged Identityを利用する

## バックエンド仕様

### 商品APIについて
 - 商品一覧はAPIでバックエンドから配信する
 - 商品詳細はAPIでバックエンドから配信する
 - 商品管理機能としてCRUD機能をAPIで提供する(本機能のみロール"admin"を必要とする)
 - 商品画像はAzure Blob Storageに画像データは保存し、SASを用いてフロント側で表示する
  - SASリンクはバックエンドAPIで生成し、フロントに返却する

### 決済APIについて
 - クレジットカード情報検証 API と クレジットカード決済 API の2つ
 - それぞれクレジットカード情報に加えてシークレットキーをリクエストBODYに入れたJSONを送信する
 - URLは実装期間中に外部機関より指定されるため、開発中は差し替えが可能となるモッククラスを作成する必要がある。（モックではAPI通信は不要）
 - 外部機関からAPI仕様が公開されてから十分な検証・開発期間が提供される（API公開から半年後がリリース日となる）ため、リスクは極めて低い。 

### 販売履歴について
 - 分析のため、販売履歴データを保存する

### パフォーマンスについて
 - 商品一覧表示は最低でも秒間1000ユーザの表示に耐えれる必要がある
 - 決済 API は同時アクセス 10を最低条件とする

## プロダクトSLA
 - 本システムのSLAは99.9%を満たすものとする
